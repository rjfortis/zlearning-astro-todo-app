---
import Layout from "../layouts/Layout.astro";
---

<Layout title="Crear Cuenta">
    <h1 class="text-2xl font-bold mb-6">Registro</h1>
    <form id="register-form" class="space-y-4">
        <div>
            <label class="block text-sm font-medium">Nombre</label>
            <input
                type="text"
                name="name"
                required
                class="w-full border p-2 rounded"
            />
        </div>
        <div>
            <label class="block text-sm font-medium">Email</label>
            <input
                type="email"
                name="email"
                required
                class="w-full border p-2 rounded"
            />
        </div>
        <div>
            <label class="block text-sm font-medium">Contraseña</label>
            <input
                type="password"
                name="password"
                required
                class="w-full border p-2 rounded"
            />
        </div>
        <button
            type="submit"
            class="w-full bg-black text-white p-2 rounded hover:bg-gray-800"
        >
            Registrarse
        </button>
    </form>
    <p class="mt-4 text-sm text-center">
        ¿Ya tienes cuenta? <a href="/login" class="underline">Inicia sesión</a>
    </p>

    <script>
        import { authClient } from "../lib/auth-client";

        const form = document.querySelector(
            "#register-form",
        ) as HTMLFormElement;
        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const formData = new FormData(form);
            const name = formData.get("name") as string;
            const email = formData.get("email") as string;
            const password = formData.get("password") as string;

            const { error } = await authClient.signUp.email({
                email,
                password,
                name,
                callbackURL: "/dashboard",
            });

            if (error) alert(error.message);
            else window.location.href = "/dashboard";
        });
    </script>
</Layout>
